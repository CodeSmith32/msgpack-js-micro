/// micro msgpack library
/// version 1.0.0
/// by Codesmith32
/// https://github.com/CodeSmith32/msgpack-js-micro

this.msgpack=function(r){"use strict";var e={},n=r.Uint8Array||function(){},t=r.ArrayBuffer||function(){};r.BigInt&&(r.BigInt(32),r.BigInt(4294967295));function i(r){if("string"==typeof r)return r;if(r&&r.constructor&&!(r instanceof n)&&r.constructor.name.match(/^(Big)?(Uint|Int|Float)(8|16|32|64)(Clamped)?Array$/)&&(r=new n(r.buffer,r.byteOffset,r.byteLength)),r instanceof t&&(r=new n(r)),r instanceof n){for(var e="",i=0;i<r.length;i+=128)e+=String.fromCharCode.apply(null,r.subarray(i,i+128));return e}throw new Error("MsgPack Error: Cannot normalize to string for value of type "+typeof r+(r?" "+r.constructor.name:""))}var o=Math.log,u=o(2),f=o(10),a=(Math.log10,Math.log2||function(r){return o(r)/u}),c=Math.abs,s=Math.floor,h=Math.round,g=Math.pow,l=g(2,149),d=g(2,1022),b=g(2,52);function w(r){return r.replace(/([\xc0-\xdf][\x80-\xbf])|([\xe0-\xef][\x80-\xbf]{2})|([\xf0-\xf7][\x80-\xbf]{3})/g,function(r,e,n,t){var i=r.charCodeAt(0),o=r.charCodeAt(1),u=r.length>2&&r.charCodeAt(2),f=r.length>3&&r.charCodeAt(3);return e?String.fromCharCode((31&i)<<6|63&o):n?String.fromCharCode((15&i)<<12|(63&o)<<6|63&u):t?String.fromCharCode((7&i)<<18|(63&o)<<12|(63&u)<<6|63&f):void 0})}var v={},p={};return e.extend=function(r){var e=r.type,n=r.varType||"object",t=r.encode,i=r.decode,o={enc:t,dec:i,ty:e};if("number"!=typeof e||e<0||e>127)throw new Error("MsgPack Error: Failed to add extension with type code: "+typeof e+" "+ +e);if("function"!=typeof t)throw new Error("MsgPack Error: Failed to add extension; missing 'encode' function");if("function"!=typeof i)throw new Error("MsgPack Error: Failed to add extension; missing 'decode' function");if(e in p)throw new Error("MsgPack Error: Failed to register extension with code "+e+"; extension code already in use");(v[n]=v[n]||[]).push(o),p[e]=o},e.encode=function(r,e){e=!!e;var t=new function r(){var e=this;if(!(e instanceof r))throw new Error("Bad instantiation of object msgpack::BinWriter");var n="";function t(r){n+=String.fromCharCode(255&r)}e.i8=function(r){return t(r),e},e.i16=function(r){return t(r>>8),t(r),e},e.i32=function(r){return t(r>>24),t(r>>16),t(r>>8),t(r),e},e.f32=function(r){if(isNaN(r))return n+="À\0\0",e;if(r===1/0)return n+="\0\0",e;if(r===-1/0)return n+="ÿ\0\0",e;if(0===r)return n+="\0\0\0\0",e;var i=r<0,o=i?-r:r,u=s(a(o)),f=h(o*g(2,23-u))-8388608;return u+=127,f>8388607&&(u++,f&=8388607),u>254?(n+=i?"ÿ\0\0":"\0\0",e):(u<=0&&(u=0,f=h(o*l)),t(i<<7|u>>1&127),t(u<<7|f>>16&127),t(f>>8),t(f),e)},e.f64=function(r){if(isNaN(r))return n+="ø\0\0\0\0\0\0",e;if(r===1/0)return n+="ð\0\0\0\0\0\0",e;if(r===-1/0)return n+="ÿð\0\0\0\0\0\0",e;if(0===r)return n+="\0\0\0\0\0\0\0\0",e;var i=r<0,o=i?-r:r,u=s(a(o)),f=h(u>0?o*g(2,52-u):o*g(2,52)*g(2,-u))-4503599627370496;return u+=1023,f>0x80000000000000&&(u++,f-=0x80000000000000),u>2046?(n+=i?"ÿð\0\0\0\0\0\0":"ð\0\0\0\0\0\0",e):(u<=0&&(u=0,f=h(o*d*b)),t(i<<7|u>>4&127),t(u<<4|f/281474976710656&15),t(f/1099511627776),t(f/4294967296),t(f/16777216),t(f/65536),t(f/256),t(f),e)},e.buf=function(r){return n+=r,e},e.data=function(){return n}},o=[];return function r(e){var n=typeof e;if(n in v)for(var u,f,h=0;h<v[n].length;h++)if(!1!==(f=(u=v[n][h]).enc(e))){if("string"!=typeof f)throw new Error("MsgPack Error: Extension code "+u.ty+" failed to return a string");1===f.length?t.i8(212):2===f.length?t.i8(213):4===f.length?t.i8(214):8===f.length?t.i8(215):16===f.length?t.i8(216):f.length<256?t.i8(199).i8(f.length):f.length<65536?t.i8(200).i16(f.length):t.i8(201).i32(f.length),t.i8(u.ty).buf(f)}if("bigint"===n&&e<=4294967295&&(e=Number(e),n="number"),e&&e.constructor.name.match(/^(Big)?(Uint|Int|Float)(8|16|32|64)(Clamped)?Array$|^(ArrayBuffer|DataView)$/))(e=i(e)).length<256?t.i8(196).i8(e.length).buf(e):e.length<65536?t.i8(197).i16(e.length).buf(e):t.i8(198).i32(e.length).buf(e);else if(null==n)t.i8(192);else if("boolean"===n)t.i8(194+e);else if("number"===n)(0|e)===e?e<0?e>=-32?t.i8(e):e>=-128?t.i8(208).i8(e):e>=-32768?t.i8(209).i16(e):e>=-2147483648?t.i8(210).i32(e):t.i8(211).i32(e/4294967296).i32(e):e<128?t.i8(e):e<256?t.i8(204).i8(e):e<65536?t.i8(205).i16(e):e<=4294967295?t.i8(206).i32(e):t.i8(207).i32(e/4294967296).i32(e):function(r){r=c(r);var e=a(r);return e<-120||e>120||(r/=g(2,s(e)-23))!==s(r)}(e)?t.i8(203).f64(e):t.i8(202).f32(e);else if("bigint"===n)t.i8(e<0?211:207),t.i32(Number(e>>bi.bits)).i32(Number(e&bi.mask));else if("string"===n)(e=e.replace(/[\x80-\uffff]/g,function(r){return(r=r.charCodeAt())<2048?String.fromCharCode(192|r>>6,128|63&r):String.fromCharCode(224|r>>12&15,128|r>>6&63,128|63&r)})).length<32?t.i8(160|e.length).buf(e):e.length<256?t.i8(217).i8(e.length).buf(e):e.length<65536?t.i8(218).i16(e.length).buf(e):t.i8(219).i32(e.length).buf(e);else if("object"===n){if(o.indexOf(e)>-1)throw new Error("MsgPack Error: Failed to encode object with recursive properties");if(o.push(e),Array.isArray(e))for(e.length<16?t.i8(144|e.length):e.length<65536?t.i8(220).i16(e.length):t.i8(221).i32(e.length),h=0;h<e.length;h++)r(e[h]);else{var l=0;for(var h in e)void 0!==e[h]&&l++;for(var h in l<16?t.i8(128|l):l<65536?t.i8(222).i16(l):t.i8(223).i32(l),e)if(void 0!==e[h]&&(r(h),r(e[h]),--l<0))throw new Error("MsgPack Error: Failed to encode transforming Proxy object");if(l)throw new Error("MsgPack Error: Failed to encode transforming Proxy object")}o.pop()}}(r),e?function(r){for(var e=new n(r.length),t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}(t.data()):t.data()},e.decode=function(r,e){e=!!e;var t=new function r(e){var n=this;if(!(n instanceof r))throw new Error("Bad instantiation of object msgpack::BinReader");var t=0;function o(r){if(t+r>e.length)throw new Error("MsgPack Error: Unexpected end of data")}function u(r){return 255&e.charCodeAt(t++)}e=i(e),n.ui8=function(){return o(1),u()},n.i8=function(){o(1);var r=u();return 128&r&&(r|=-256),r},n.ui16=function(){return o(2),256*u()+u()},n.i16=function(){o(2);var r=256*u()+u();return 32768&r&&(r|=-65537),r},n.ui32=function(){return o(4),16777216*u()+65536*u()+256*u()+u()>>>0},n.i32=function(){return o(4),16777216*u()+65536*u()+256*u()+u()},n.f32=function(){o(4);var r=16777216*u()+65536*u()+256*u()+u(),e=!!(2147483648&r),n=r>>23&255,t=8388607&r;return 255===n?0===t?e?-1/0:1/0:NaN:0===n?t/l:(t+=8388608)*(e?-1:1)*g(2,n-127-23)},n.f64=function(){o(8);var r=16777216*u()+65536*u()+256*u()+u(),e=!!(2147483648&r),n=r>>20&2047,t=4294967296*(1048575&r)+(16777216*u()+65536*u()+256*u()+u());return 2047===n?0===t?e?-1/0:1/0:NaN:0===n?t/d/b:(t/b+1)*(e?-1:1)*g(2,n-1023)},n.buf=function(r){o(r);var n=e.slice(t,t+r);return t+=r,n},n.eof=function(){return t>=e.length}}(r);function o(r){for(var e={},n=0;n<r;n++)e[c()]=c();return e}function u(r){for(var e=[],n=0;n<r;n++)e.push(c());return e}function f(r){if(!e)return r;for(var t=new n(r.length),i=0;i<r.length;i++)t[i]=r.charCodeAt(i);return t.buffer}function a(r,e){return r in p?p[r].dec(e):(console.warn("MsgPack Warning: Failed to decode unregistered extension type "+r),null)}function c(){var r,e=t.ui8();if(0==(128&e))return e;if(224==(224&e))return-256|e;if(128==(240&e))return o(15&e);if(144==(240&e))return u(15&e);if(160==(224&e))return w(t.buf(31&e));switch(e){case 193:case 192:return null;case 194:return!1;case 195:return!0;case 196:return f(t.buf(t.ui8()));case 197:return f(t.buf(t.ui16()));case 198:return f(t.buf(t.ui32()));case 199:return r=t.ui8(),a(t.ui8(),t.buf(r));case 200:return r=t.ui16(),a(t.ui8(),t.buf(r));case 201:return r=t.ui32(),a(t.ui8(),t.buf(r));case 202:return t.f32();case 203:return t.f64();case 204:return t.ui8();case 205:return t.ui16();case 206:return t.ui32();case 207:return 4294967296*t.ui32()+t.ui32();case 208:return t.i8();case 209:return t.i16();case 210:return t.i32();case 211:return(r=4294967296*t.i32())+(r<0?-1:1)*t.ui32();case 212:return a(t.i8(),t.buf(1));case 213:return a(t.i8(),t.buf(2));case 214:return a(t.i8(),t.buf(4));case 215:return a(t.i8(),t.buf(8));case 216:return a(t.i8(),t.buf(16));case 217:return w(t.buf(t.ui8()));case 218:return w(t.buf(t.ui16()));case 219:return w(t.buf(t.ui32()));case 220:return u(t.ui16());case 221:return u(t.ui32());case 222:return o(t.ui16());case 223:return o(t.ui32())}throw new Error("MsgPack Error: Somehow encountered unknown byte code: "+e)}var o=c();if(!t.eof())throw new Error("MsgPack Error: Trying to decode more data than expected");return o},"object"==typeof r.module&&"object"==typeof r.module.exports&&(module.exports=e),e}(this);